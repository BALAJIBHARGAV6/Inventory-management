# Deployment Guide

## üöÄ Professional E-commerce Inventory Management System

This guide will help you deploy the complete inventory management system with AI forecasting to production.

## üìã Prerequisites

- GitHub account
- Vercel account (for frontend)
- Render account (for backend) - **Free tier available**
- Supabase account (for database)
- Groq API key (for AI features)

## üóÑÔ∏è Database Setup (Supabase)

1. **Create Supabase Project**
   - Go to [supabase.com](https://supabase.com)
   - Create new project
   - Note down your `Project URL` and `anon public key`

2. **Run Database Schema**
   ```sql
   -- Copy and run the entire database-schema.sql file in Supabase SQL editor
   ```

3. **Insert Sample Data**
   ```sql
   -- Run the sample data inserts from database-schema.sql
   ```

## üîß Backend Deployment (Render)

### Step-by-Step Render Deployment

**See detailed guide:** [RENDER_DEPLOYMENT.md](./RENDER_DEPLOYMENT.md)

1. **Push to GitHub**
   ```bash
   git add .
   git commit -m "Deploy inventory management system to Render"
   git push origin main
   ```

2. **Deploy to Render**
   - Go to [render.com](https://render.com) and sign up/login
   - Click **New +** ‚Üí **Blueprint**
   - Connect your GitHub repository
   - Render auto-detects `render.yaml` configuration
   - Click **Apply**

3. **Add Environment Variables**
   
   In Render dashboard, add these variables:
   
   ```
   SUPABASE_URL=your_supabase_project_url
   SUPABASE_SERVICE_KEY=your_supabase_service_role_key
   GROQ_API_KEY=gsk_your-groq-api-key
   CORS_ORIGIN=https://your-vercel-app.vercel.app,*.vercel.app,http://localhost:3000
   ```
   
   **Important:**
   - Replace `your-vercel-app` with your actual Vercel project name
   - `JWT_SECRET` is auto-generated by Render
   - `NODE_ENV` and `PORT` are set in `render.yaml`

4. **Copy Your Render URL**
   - After deployment, copy the URL (e.g., `https://inventory-management-backend.onrender.com`)
   - You'll need this for frontend configuration

## üåê Frontend Deployment (Vercel)

1. **Deploy to Vercel**
   - Go to [vercel.com](https://vercel.com)
   - Import your GitHub repository
   - Set root directory to `frontend`
   - Add environment variables:
     ```
     NEXT_PUBLIC_API_URL=https://your-backend.onrender.com
     NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
     NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
     ```
   - Replace with your actual Render URL (or Railway URL if using Railway)

2. **Configure Domain**
   - Set up custom domain (optional)
   - Update CORS_ORIGIN in backend with your Vercel URL

## ‚úÖ Post-Deployment Checklist

### Backend Health Check
```bash
curl https://your-app.onrender.com/health
```
Should return:
```json
{
  "status": "ok",
  "timestamp": "2024-01-18T...",
  "database": "configured",
  "environment": "production"
}
```

### Test API Endpoints
```bash
# Test inventory stats
curl https://your-app.onrender.com/api/inventory/stats

# Test products
curl https://your-app.onrender.com/api/products

# Test orders
curl https://your-app.onrender.com/api/orders/admin/all
```

### Frontend Verification
1. Visit your Vercel URL
2. Check admin dashboard: `/admin`
3. Test all tabs: Dashboard, Products, Inventory, Orders, AI Forecasting
4. Verify real data loading from Supabase

## üîê Security Configuration

### Environment Variables
- **Never commit** `.env` files to GitHub
- Use strong JWT secrets (32+ characters)
- Rotate API keys regularly

### CORS Configuration
- Set specific origins, avoid wildcards in production
- Update CORS_ORIGIN when changing domains

### Database Security
- Use Row Level Security (RLS) in Supabase
- Create proper user roles and permissions
- Enable API rate limiting

## üìä Features Deployed

### ‚úÖ Admin Dashboard
- **Real-time Inventory**: Live stock levels and values
- **Order Management**: Approve/reject orders with inventory updates
- **AI Forecasting**: 30/60/90 day predictions with Indian market intelligence
- **Product Management**: Add, edit, update products
- **Analytics**: Comprehensive business insights

### ‚úÖ Order System
- **Customer Orders**: Place orders from frontend
- **Admin Approval**: Review and approve orders
- **Inventory Updates**: Automatic stock reduction on approval
- **Status Tracking**: Real-time order status updates

### ‚úÖ AI Features
- **Demand Forecasting**: Seasonal and festival-based predictions
- **Product Recommendations**: AI-suggested products for Indian market
- **Market Intelligence**: Economic trends and consumer behavior
- **Inventory Optimization**: Smart restock recommendations

## üéØ Production URLs

After deployment, you'll have:
- **Frontend**: `https://your-app.vercel.app`
- **Admin Dashboard**: `https://your-app.vercel.app/admin`
- **Backend API**: `https://your-app.onrender.com`
- **Database**: Supabase hosted PostgreSQL

## üö® Troubleshooting

### Common Issues

1. **CORS Errors** ‚ö†Ô∏è CRITICAL FIX
   ```
   Access to fetch at 'https://your-backend.onrender.com/api/...' from origin 
   'https://your-app.vercel.app' has been blocked by CORS policy
   ```
   
   **Solution:**
   - Go to your backend hosting (Render/Railway)
   - Update `CORS_ORIGIN` environment variable to:
     ```
     https://inventory-management-ecommerce.vercel.app,*.vercel.app,http://localhost:3000
     ```
   - **Must include:**
     - Your exact Vercel production URL
     - `*.vercel.app` for all preview deployments
     - Local development URL
   - Restart/redeploy backend after updating
   - Clear browser cache and hard refresh (Ctrl+Shift+R)

2. **Database Connection**
   - Verify SUPABASE_URL and SUPABASE_SERVICE_KEY in backend
   - Use SERVICE_KEY not ANON_KEY for backend
   - Check database schema is properly created
   - Test connection via `/health` endpoint

3. **Build Failures**
   - Check TypeScript errors in deployment logs
   - Ensure all dependencies are in package.json
   - Verify build command is correct
   - Test build locally first: `npm run build`

4. **API Not Loading / 404 Errors**
   - Verify NEXT_PUBLIC_API_URL in Vercel matches backend URL
   - Check backend is running with `/health` endpoint
   - Ensure no trailing slashes in API URL
   - Check backend logs for errors

5. **React Minified Errors (#425, #422)**
   - Usually caused by CORS blocking API requests
   - Fix CORS configuration first
   - Check browser console for actual error details
   - Verify all API endpoints are accessible

### Support
- Check Render logs for backend issues (Dashboard ‚Üí Service ‚Üí Logs)
- Check Vercel function logs for frontend issues
- Monitor Supabase dashboard for database performance

## üéâ Success!

Your professional e-commerce inventory management system is now live with:
- ‚úÖ Real-time inventory tracking
- ‚úÖ AI-powered forecasting
- ‚úÖ Order management with approval workflow
- ‚úÖ Indian market intelligence
- ‚úÖ Professional admin dashboard
- ‚úÖ Scalable cloud infrastructure

**Admin Dashboard**: `https://your-app.vercel.app/admin`
