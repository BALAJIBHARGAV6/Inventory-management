# üîê Environment Variables Setup Guide

Complete guide for setting up environment variables for Render (Backend) and Vercel (Frontend).

---

## üéØ Backend Environment Variables (Render)

### Where to Add:
1. Go to https://dashboard.render.com/
2. Select your service: `inventory-management-backend`
3. Click **Environment** tab
4. Click **Add Environment Variable**

### Required Variables:

```bash
# Supabase Database Configuration
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# AI Configuration (Groq)
GROQ_API_KEY=gsk_your_groq_api_key_here

# CORS Configuration (CRITICAL!)
CORS_ORIGIN=https://inventory-management-ecommerce.vercel.app,*.vercel.app,http://localhost:3000

# Server Configuration (Auto-set by render.yaml)
NODE_ENV=production
PORT=4000

# JWT Secret (Auto-generated by Render)
JWT_SECRET=auto-generated-by-render
```

### üìã How to Get Each Value:

#### 1. SUPABASE_URL
- Go to https://app.supabase.com/
- Select your project
- Settings ‚Üí API
- Copy **Project URL**
- Example: `https://abcdefghijklmnop.supabase.co`

#### 2. SUPABASE_SERVICE_KEY
- Same page (Settings ‚Üí API)
- Copy **service_role** key (NOT anon key!)
- ‚ö†Ô∏è **IMPORTANT**: Use service_role key for backend
- Starts with: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`

#### 3. GROQ_API_KEY
- Go to https://console.groq.com/
- Sign up/Login
- API Keys ‚Üí Create API Key
- Copy the key
- Starts with: `gsk_...`

#### 4. CORS_ORIGIN
- **Replace** `inventory-management-ecommerce` with YOUR Vercel project name
- Format: `https://YOUR-PROJECT-NAME.vercel.app,*.vercel.app,http://localhost:3000`
- Example: `https://my-inventory-app.vercel.app,*.vercel.app,http://localhost:3000`
- ‚ö†Ô∏è **CRITICAL**: This must match your Vercel URL exactly!

---

## üåê Frontend Environment Variables (Vercel)

### Where to Add:
1. Go to https://vercel.com/dashboard
2. Select your project
3. Settings ‚Üí Environment Variables
4. Add each variable for **Production**, **Preview**, and **Development**

### Required Variables:

```bash
# Backend API URL (Your Render URL)
NEXT_PUBLIC_API_URL=https://inventory-management-backend.onrender.com

# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### üìã How to Get Each Value:

#### 1. NEXT_PUBLIC_API_URL
- After deploying to Render, copy your service URL
- Go to Render Dashboard ‚Üí Your Service
- Copy the URL at the top (e.g., `https://inventory-management-backend.onrender.com`)
- ‚ö†Ô∏è **NO trailing slash!**

#### 2. NEXT_PUBLIC_SUPABASE_URL
- Same as backend SUPABASE_URL
- Go to Supabase ‚Üí Settings ‚Üí API
- Copy **Project URL**

#### 3. NEXT_PUBLIC_SUPABASE_ANON_KEY
- Go to Supabase ‚Üí Settings ‚Üí API
- Copy **anon public** key (NOT service_role!)
- ‚ö†Ô∏è **IMPORTANT**: Use anon key for frontend
- Starts with: `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`

---

## üìù Complete Setup Checklist

### Backend (Render)
- [ ] `SUPABASE_URL` - Project URL from Supabase
- [ ] `SUPABASE_SERVICE_KEY` - Service role key from Supabase
- [ ] `GROQ_API_KEY` - API key from Groq Console
- [ ] `CORS_ORIGIN` - Your Vercel URL with wildcard
- [ ] `NODE_ENV` - Set to `production` (in render.yaml)
- [ ] `PORT` - Set to `4000` (in render.yaml)
- [ ] `JWT_SECRET` - Auto-generated by Render

### Frontend (Vercel)
- [ ] `NEXT_PUBLIC_API_URL` - Your Render backend URL
- [ ] `NEXT_PUBLIC_SUPABASE_URL` - Supabase project URL
- [ ] `NEXT_PUBLIC_SUPABASE_ANON_KEY` - Supabase anon key

---

## üéØ Example Configuration

### Backend (Render) - Example Values

```bash
SUPABASE_URL=https://xyzabc123.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5emFiYzEyMyIsInJvbGUiOiJzZXJ2aWNlX3JvbGUiLCJpYXQiOjE2ODk1ODQ0MDAsImV4cCI6MjAwNTE2MDQwMH0.abc123def456
GROQ_API_KEY=gsk_1234567890abcdefghijklmnopqrstuvwxyz
CORS_ORIGIN=https://my-inventory-app.vercel.app,*.vercel.app,http://localhost:3000
NODE_ENV=production
PORT=4000
```

### Frontend (Vercel) - Example Values

```bash
NEXT_PUBLIC_API_URL=https://inventory-management-backend.onrender.com
NEXT_PUBLIC_SUPABASE_URL=https://xyzabc123.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5emFiYzEyMyIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNjg5NTg0NDAwLCJleHAiOjIwMDUxNjA0MDB9.xyz789ghi012
```

---

## ‚ö†Ô∏è Common Mistakes to Avoid

### Backend
‚ùå Using anon key instead of service_role key
‚úÖ Use service_role key for SUPABASE_SERVICE_KEY

‚ùå Missing wildcard in CORS_ORIGIN
‚úÖ Include `*.vercel.app` for preview deployments

‚ùå Wrong Vercel URL in CORS_ORIGIN
‚úÖ Use exact URL from Vercel dashboard

### Frontend
‚ùå Using service_role key instead of anon key
‚úÖ Use anon public key for NEXT_PUBLIC_SUPABASE_ANON_KEY

‚ùå Trailing slash in API URL
‚úÖ No trailing slash: `https://your-app.onrender.com`

‚ùå Wrong Render URL
‚úÖ Copy exact URL from Render dashboard

---

## üîÑ After Adding Variables

### Render (Backend)
1. Variables are added ‚Üí Service auto-redeploys
2. Wait 2-3 minutes for deployment
3. Check logs: Dashboard ‚Üí Service ‚Üí Logs
4. Test health endpoint: `https://your-app.onrender.com/health`

### Vercel (Frontend)
1. After adding variables ‚Üí Click **Redeploy**
2. Go to Deployments tab
3. Click latest deployment ‚Üí **Redeploy**
4. Wait 1-2 minutes
5. Visit your site and test

---

## ‚úÖ Verification Steps

### 1. Test Backend Health
```bash
curl https://your-app.onrender.com/health
```

Expected response:
```json
{
  "status": "ok",
  "timestamp": "2024-01-18T10:30:00.000Z",
  "database": "configured",
  "environment": "production"
}
```

### 2. Test Backend API
```bash
curl https://your-app.onrender.com/api/products?limit=5
```

Should return products data.

### 3. Test Frontend
1. Visit: `https://your-app.vercel.app/admin`
2. Check browser console (F12) for errors
3. Verify data loads in all tabs

---

## üÜò Troubleshooting

### "Database not configured" in health check
- Check SUPABASE_URL is correct
- Check SUPABASE_SERVICE_KEY is the service_role key
- Verify keys in Render dashboard

### CORS errors in browser
- Check CORS_ORIGIN includes your exact Vercel URL
- Verify wildcard `*.vercel.app` is included
- Redeploy backend after changing CORS_ORIGIN
- Clear browser cache

### "Failed to fetch" errors
- Check NEXT_PUBLIC_API_URL is correct Render URL
- Verify backend is running (test /health endpoint)
- Check no trailing slash in API URL
- Redeploy frontend after changing API URL

### AI features not working
- Verify GROQ_API_KEY is correct
- Check Groq Console for API key status
- Verify key starts with `gsk_`

---

## üìû Quick Reference

| Variable | Location | Key Type | Example |
|----------|----------|----------|---------|
| SUPABASE_URL | Both | Project URL | `https://abc123.supabase.co` |
| SUPABASE_SERVICE_KEY | Backend only | service_role | `eyJhbG...` (long) |
| SUPABASE_ANON_KEY | Frontend only | anon public | `eyJhbG...` (long) |
| GROQ_API_KEY | Backend only | API key | `gsk_...` |
| CORS_ORIGIN | Backend only | URLs | `https://app.vercel.app,*.vercel.app` |
| NEXT_PUBLIC_API_URL | Frontend only | Backend URL | `https://app.onrender.com` |

---

**Last Updated:** January 18, 2024
**Deployment Platform:** Render + Vercel
